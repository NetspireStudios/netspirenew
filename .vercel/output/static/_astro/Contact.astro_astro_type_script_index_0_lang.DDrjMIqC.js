function O(){console.log("📧 Initializing professional contact form...");let m=!1,E=0;const B=5e3,i=document.getElementById("contact-form"),n=document.getElementById("submit-button"),u=n?.querySelector(".btn-text"),g=n?.querySelector(".btn-spinner"),f=n?.querySelector(".btn-icon"),C=document.getElementById("form-messages"),v=document.getElementById("success-message"),w=document.getElementById("error-message"),j=document.getElementById("success-text"),z=document.getElementById("error-text"),x=document.getElementById("name-error"),I=document.getElementById("email-error"),L=document.getElementById("message-error"),y=document.getElementById("message"),F=document.getElementById("char-count"),T=document.querySelector(".character-count");if(!i||!n){console.error("❌ Contact form elements not found");return}function U(){const e=()=>{[{selector:".title-word",delay:0},{selector:".contact-description",delay:200},{selector:".form-container",delay:400},{selector:".info-container",delay:600}].forEach(({selector:s,delay:o})=>{setTimeout(()=>{const a=document.querySelector(s);a&&(a.style.opacity="1",a.style.transform="translateY(0)")},o)})};typeof gsap<"u"&&typeof ScrollTrigger<"u"?(console.log("✅ Using GSAP for contact animations"),gsap.registerPlugin(ScrollTrigger),gsap.timeline({scrollTrigger:{trigger:".contact-header",start:"top 85%",toggleActions:"play none none reverse"}}).from(".title-word",{y:50,opacity:0,duration:.8,stagger:.1,ease:"power3.out"}).from(".contact-description",{y:30,opacity:0,duration:.6,ease:"power3.out"},"-=0.4"),gsap.timeline({scrollTrigger:{trigger:".contact-content",start:"top 80%",toggleActions:"play none none reverse"}}).from(".form-container",{x:-50,opacity:0,duration:.8,ease:"power3.out"}).from(".info-container",{x:50,opacity:0,duration:.8,ease:"power3.out"},"-=0.6").from(".contact-method",{y:20,opacity:0,duration:.5,stagger:.1,ease:"power3.out"},"-=0.4")):(console.log("⚠️ GSAP not available, using fallback animations"),setTimeout(e,500))}function P(e){return e.trim()?e.trim().length<2?"Name must be at least 2 characters":e.trim().length>100?"Name must be less than 100 characters":/^[a-zA-Z\s\-'\.]+$/.test(e.trim())?null:"Name contains invalid characters":"Name is required"}function M(e){return e.trim()?e.length>100?"Email must be less than 100 characters":/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.trim())?null:"Please enter a valid email address":"Email is required"}function k(e){return e.trim()?e.trim().length<10?"Please provide more details (at least 10 characters)":e.length>2e3?"Message is too long (maximum 2000 characters)":null:"Project details are required"}function p(e,t,s){e.classList.add("error"),t.textContent=s,t.classList.add("show")}function l(e,t){e.classList.remove("error"),t.textContent="",t.classList.remove("show")}function c(e,t){C.style.display="block",e==="success"?(j.textContent=t,v.style.display="flex",w.style.display="none"):(z.textContent=t,w.style.display="flex",v.style.display="none"),setTimeout(()=>{C.style.display="none",v.style.display="none",w.style.display="none"},5e3)}function S(){if(!y||!F)return;const e=y.value.length;F.textContent=e.toString(),T.classList.remove("warning","error"),e>1800?T.classList.add("error"):e>1500&&T.classList.add("warning")}async function V(e){try{const t=await fetch("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e.get("name"),email:e.get("email"),company:e.get("company"),budget:e.get("budget"),services:e.getAll("services"),message:e.get("message"),website:e.get("website")})}),s=await t.json();if(!t.ok)throw new Error(s.error||"Failed to send message");return{success:!0,message:s.message}}catch(t){return console.error("Form submission error:",t),{success:!1,message:t instanceof Error?t.message:"Failed to send message. Please try again."}}}function r(e){switch(n.classList.remove("loading","success","error"),e){case"loading":n.classList.add("loading"),n.disabled=!0,u.textContent="Sending...",g.style.display="block",f.style.display="none";break;case"success":n.classList.add("success"),n.disabled=!1,u.textContent="Message Sent!",g.style.display="none",f.style.display="block";break;case"error":n.classList.add("error"),n.disabled=!1,u.textContent="Try Again",g.style.display="none",f.style.display="block";break;default:n.disabled=!1,u.textContent="Send Message",g.style.display="none",f.style.display="block"}}i.addEventListener("submit",async e=>{e.preventDefault();const t=Date.now();if(t-E<B){const d=Math.ceil((B-(t-E))/1e3);c("error",`Please wait ${d} seconds before submitting again.`);return}if(m){console.log("⚠️ Form already submitting");return}console.log("📤 Form submission started"),m=!0,E=t;const s=document.getElementById("name"),o=document.getElementById("email"),a=document.getElementById("message");l(s,x),l(o,I),l(a,L);let b=!1;const A=P(s.value);A&&(p(s,x,A),b=!0);const q=M(o.value);q&&(p(o,I,q),b=!0);const N=k(a.value);if(N&&(p(a,L,N),b=!0),b){m=!1,c("error","Please fix the errors above and try again.");return}r("loading");try{const d=new FormData(i),h=await V(d);h.success?(console.log("✅ Form submitted successfully"),r("success"),c("success",h.message),setTimeout(()=>{i.reset(),S(),r("normal")},3e3)):(console.log("❌ Form submission failed:",h.message),r("error"),c("error",h.message),setTimeout(()=>{r("normal")},3e3))}catch(d){console.error("❌ Unexpected error:",d),r("error"),c("error","An unexpected error occurred. Please try again."),setTimeout(()=>{r("normal")},3e3)}finally{m=!1}}),[{field:document.getElementById("name"),validator:P,error:x},{field:document.getElementById("email"),validator:M,error:I},{field:document.getElementById("message"),validator:k,error:L}].forEach(({field:e,validator:t,error:s})=>{e&&s&&(e.addEventListener("blur",()=>{const o=t(e.value);o?p(e,s,o):l(e,s)}),e.addEventListener("input",()=>{s.classList.contains("show")&&(t(e.value)||l(e,s))}))}),y&&(y.addEventListener("input",S),S()),i.querySelectorAll(".form-input, .form-select, .form-textarea").forEach(e=>{e.addEventListener("focus",()=>{const t=e.closest(".form-group");t&&t.classList.add("focused")}),e.addEventListener("blur",()=>{const t=e.closest(".form-group");t&&t.classList.remove("focused")})}),U(),console.log("✅ Professional contact form initialized with full functionality")}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",O):O();
